### **① 本番環境用データ投入スクリプト (2025/11〜2026/1)**

Renderのダッシュボードから「Shell」を開き、`flask shell` を起動した状態で、以下のコードを**全てコピー＆ペーストして実行**してください。

```python
from datetime import date, time
from motopuppu.models import db, TrackSchedule

# --- 定数定義 ---
AM_SLOTS = [
    (time(9, 0), time(9, 15), "ミニバイク①"), (time(9, 15), time(9, 30), "ミニバイク②"),
    (time(9, 30), time(9, 45), "大型バイク①"), (time(9, 45), time(10, 0), "大型バイク②"),
    (time(10, 0), time(10, 15), "ミニバイク①"), (time(10, 15), time(10, 30), "ミニバイク②"),
    (time(10, 30), time(10, 45), "大型バイク①"), (time(10, 45), time(11, 0), "大型バイク②"),
    (time(11, 0), time(11, 15), "ミニバイク①"), (time(11, 15), time(11, 30), "ミニバイク②"),
    (time(11, 30), time(11, 45), "大型バイク①"), (time(11, 45), time(12, 0), "大型バイク②"),
    (time(12, 0), time(12, 15), "ミニバイク①"), (time(12, 15), time(12, 30), "ミニバイク②"),
]
PM_SLOTS = [
    (time(13, 0), time(13, 15), "ミニバイク①"), (time(13, 15), time(13, 30), "ミニバイク②"),
    (time(13, 30), time(13, 45), "大型バイク①"), (time(13, 45), time(14, 0), "大型バイク②"),
    (time(14, 0), time(14, 15), "ミニバイク①"), (time(14, 15), time(14, 30), "ミニバイク②"),
    (time(14, 30), time(14, 45), "大型バイク①"), (time(14, 45), time(15, 0), "大型バイク②"),
    (time(15, 0), time(15, 15), "ミニバイク①"), (time(15, 15), time(15, 30), "ミニバイク②"),
    (time(15, 30), time(15, 45), "大型バイク①"), (time(15, 45), time(16, 0), "大型バイク②"),
    (time(16, 0), time(16, 15), "ミニバイク①"), (time(16, 15), time(16, 30), "ミニバイク②"),
]

# --- 登録データ作成 ---
schedules_to_add = []

target_days = [
    # 11月
    (date(2025, 11, 1), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 4), "ミドルコース", "ミドルコース", ""),
    (date(2025, 11, 5), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 7), "ミドルコース", "ミドルコース", ""),
    (date(2025, 11, 8), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 9), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 10), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 11), "ミドルコース", "ミドルコース", ""),
    (date(2025, 11, 12), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 14), "ミドルコース", "ミドルコース", ""),
    (date(2025, 11, 15), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 16), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 17), "ミドルコース", "ミドルコース", ""),
    (date(2025, 11, 18), "ミドルコース", "ミドルコース", ""),
    (date(2025, 11, 19), "ミドルコース", "ミドルコース", "昼休みスタート練習"),
    (date(2025, 11, 21), "ミドルコース", "ミドルコース", ""),
    (date(2025, 11, 22), "ミドルコース", "ミドルコース", "入門枠あり"),
    (date(2025, 11, 24), "ミドルコース", "ロングコース", "入門枠あり"),
    (date(2025, 11, 25), "ミドルコース", None, "午後休業"),
    (date(2025, 11, 26), "ミドルコース", "ロングコース", "入門枠あり"),
    (date(2025, 11, 28), "ミドルコース", "ロングコース", "入門枠あり"),
    (date(2025, 11, 30), "ミドルコース", "ロングコース", "入門枠あり"),
    # 12月
    (date(2025, 12, 1), "ミドルコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 2), "ミドルコース", "ロングコース", ""),
    (date(2025, 12, 3), "ミドルコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 5), "ミドルコース", "ロングコース", ""),
    (date(2025, 12, 6), "ミドルコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 8), "ミドルコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 9), "ミドルコース", "ロングコース", ""),
    (date(2025, 12, 10), "ミドルコース", "ロングコース", "昼休みスタート練習"),
    (date(2025, 12, 12), "ミドルコース", "ロングコース", ""),
    (date(2025, 12, 15), "ロングコース", None, "午後休業"),
    (date(2025, 12, 16), None, "ロングコース", "午前貸切"),
    (date(2025, 12, 17), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 19), "ロングコース", "ロングコース", ""),
    (date(2025, 12, 20), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 22), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 23), "ロングコース", "ロングコース", ""),
    (date(2025, 12, 24), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 26), "ロングコース", None, "午後貸切"),
    (date(2025, 12, 28), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2025, 12, 30), "ロングコース", None, "午後休業"),
    # 1月
    (date(2026, 1, 3), "ロングコース", "ロングコース", "変則日程の可能性あり"),
    (date(2026, 1, 4), "ロングコース", None, "午後ピン耐"),
    (date(2026, 1, 5), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 6), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 7), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 9), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 10), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 12), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 13), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 14), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 16), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 17), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 18), "ロングコース", None, "午後ビギナーズデー"),
    (date(2026, 1, 19), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 20), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 21), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 23), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 24), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 25), "ロングコース", None, "午後ピン耐"),
    (date(2026, 1, 26), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 27), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 28), "ロングコース", "ロングコース", "入門枠あり"),
    (date(2026, 1, 30), "ロングコース", "ロングコース", ""),
    (date(2026, 1, 31), "ロングコース", "ロングコース", "")
]

# --- 登録処理 ---
for target_date, am_course, pm_course, notes in target_days:
    TrackSchedule.query.filter(
        TrackSchedule.circuit_name.like("桶川スポーツランド%"),
        TrackSchedule.date == target_date
    ).delete(synchronize_session=False)
    
    if am_course:
        name = f"桶川スポーツランド {am_course}"
        for start, end, title in AM_SLOTS:
            schedules_to_add.append(TrackSchedule(circuit_name=name, date=target_date, start_time=start, end_time=end, title=title, notes=notes))
    if pm_course:
        name = f"桶川スポーツランド {pm_course}"
        for start, end, title in PM_SLOTS:
            schedules_to_add.append(TrackSchedule(circuit_name=name, date=target_date, start_time=start, end_time=end, title=title, notes=notes))

if schedules_to_add:
    db.session.add_all(schedules_to_add)
    db.session.commit()
    print(f"=== 完了: データ登録数 {len(schedules_to_add)} 件 ===")
else:
    print("登録するデータがありませんでした。")
```

-----

### **② 今後の走行枠データ更新手順書 (Reference Manual)**

今後（例：2026年2月以降）、新しいスケジュールを登録する際の手順です。

#### **STEP 1: スケジュール情報の入手**

公式サイト ([okspo.jp](https://okspo.jp/)) の「お知らせ」や「スケジュール」ページから、翌月以降のスケジュール表（テキスト）をコピーします。

#### **STEP 2: Geminiへの依頼**

Gemini（またはChatGPT等のAI）に以下のプロンプトを入力し、今回作成したようなPythonコードを生成させます。

> **【プロンプト例】**
>
> 以下のテキストデータは、桶川スポーツランドの2026年2月のスケジュールです。
> Flaskアプリケーションの `TrackSchedule` モデルにデータを投入するための、`flask shell` で実行可能なPythonスクリプトを作成してください。
>
> **条件:**
>
>   * 既存の `AM_SLOTS` と `PM_SLOTS` の定義は再利用する前提でコードに含めてください。
>   * `register_day(date, am_course, pm_course, notes)` という形式のヘルパー関数を使用してください。
>   * テキストデータから、「日付」「午前コース」「午後コース」「備考（入門枠など）」を読み取ってください。
>
> **スケジュールテキスト:**
> (ここにWebサイトからコピーしたテキストを貼り付ける)

#### **STEP 3: 本番環境での実行**

1.  **Render Dashboard** にログインします。
2.  対象の Web Service を選択します。
3.  **"Shell"** タブをクリックします。
4.  ターミナルが起動したら、`flask shell` と入力してEnterキーを押します。
5.  `>>>` プロンプトが表示されたら、STEP 2で生成されたPythonコードを貼り付けて実行します。
6.  最後に `db.session.commit()` が実行され、完了メッセージが表示されれば更新完了です。

-----
